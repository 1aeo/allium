{% extends "skeleton.html" -%}
{% block title -%}
	Tor Relays :: {{ relay['nickname'] }}
{% endblock -%}
{% block body -%}
<div id="content">
<h2>
<a href="{{ path_prefix }}">Home</a> :: Relay "{{ relay['nickname'] }}"
</h2>
<p>Last fetch was at {{ relays.timestamp }}.</p>
<div class="row">
<div class="col-md-6">
<dl>
<dt>
Nickname
</dt>
<dd>
{{ relay['nickname']|escape }}
</dd>

<dt>
AROI <a href="https://nusenu.github.io/ContactInfo-Information-Sharing-Specification/" target="_blank" title="Autonomous Relay Operator Identifier - unverified">(?)</a>
</dt>
{% if relay['aroi_domain'] and relay['aroi_domain'] != 'none' -%}
<dd>
<a href="{{ path_prefix }}contact/{{ relay['contact_md5'] }}/">{{ relay['aroi_domain']|escape }}</a>
</dd>
{% else -%}
<dd>
none
</dd>
{% endif -%}
<dt>
Contact
</dt>
{% if relay['contact'] -%}
<dd>
<a href="{{ path_prefix }}contact/{{ relay['contact_md5'] }}/">{{
relay['contact']|escape }}</a>
</dd>
{% else -%}
<dd>
<a href="{{ path_prefix }}contact/{{ relay['contact_md5'] }}">none</a>
</dd>
{% endif -%}
<dt title="IP address and TCP port where this relay accepts onion-routing connections, with hostname when available">
OR Address
</dt>
<dd>
{% if relay['verified_host_names'] -%}
{% for hostname in relay['verified_host_names'] -%}
<span class="verified-hostname" title="verified hostname">{{ hostname|escape }}</span>{% if not loop.last %}, {% endif %}
{% endfor %} | {% for address in relay['or_addresses'] -%}{{ address }}{% if not loop.last %}, {% endif %}{% endfor -%}
{% elif relay['unverified_host_names'] -%}
{% for hostname in relay['unverified_host_names'] -%}
<span class="unverified-hostname" title="unverified hostname">{{ hostname|escape }}</span>{% if not loop.last %}, {% endif %}
{% endfor %} | {% for address in relay['or_addresses'] -%}{{ address }}{% if not loop.last %}, {% endif %}{% endfor -%}
{% else -%}
{% for address in relay['or_addresses'] -%}{{ address }}{% if not loop.last %}, {% endif %}{% endfor -%}
{% endif -%}
</dd>
<dt>
Exit Address
</dt>
{% if relay['exit_address'] -%}
<dd>
{{ relay['exit_address']|escape }}
</dd>
{% else -%}
<dd>
none
</dd>
{% endif -%}
<dt>
Dir Address
</dt>
{% if relay['dir_address'] -%}
<dd>
<a href="http://{{ relay['dir_address']|escape }}">{{
relay['dir_address']|escape }}</a>
</dd>
{% else -%}
<dd>
none
</dd>
{% endif -%}
<dt title="Bandwidth details: Observed capacity | Advertised capability | Rate limit | Burst limit">
Bandwidth (Observed | Advertised | Rate | Burst)
</dt>
{% set obs_unit = relays._determine_unit(relay['observed_bandwidth']) -%}
{% set obs_bandwidth = relays._format_bandwidth_with_unit(relay['observed_bandwidth'], obs_unit) -%}
<dd>
<span title="Observed: {{ obs_bandwidth }} {{ obs_unit }}">{{ obs_bandwidth }} {{ obs_unit }}</span> | 
<span title="Advertised: {% if relay['advertised_bandwidth'] -%}{% set adv_unit = relays._determine_unit(relay['advertised_bandwidth']) -%}{% set adv_bandwidth = relays._format_bandwidth_with_unit(relay['advertised_bandwidth'], adv_unit) -%}{{ adv_bandwidth }} {{ adv_unit }}{% else -%}unknown{% endif -%}">{% if relay['advertised_bandwidth'] -%}{% set adv_unit = relays._determine_unit(relay['advertised_bandwidth']) -%}{% set adv_bandwidth = relays._format_bandwidth_with_unit(relay['advertised_bandwidth'], adv_unit) -%}{{ adv_bandwidth }} {{ adv_unit }}{% else -%}unknown{% endif -%}</span> | 
<span title="Rate: {% if relay['bandwidth_rate'] -%}{% set rate_unit = relays._determine_unit(relay['bandwidth_rate']) -%}{% set rate_bandwidth = relays._format_bandwidth_with_unit(relay['bandwidth_rate'], rate_unit) -%}{{ rate_bandwidth }} {{ rate_unit }}{% else -%}unknown{% endif -%}">{% if relay['bandwidth_rate'] -%}{% set rate_unit = relays._determine_unit(relay['bandwidth_rate']) -%}{% set rate_bandwidth = relays._format_bandwidth_with_unit(relay['bandwidth_rate'], rate_unit) -%}{{ rate_bandwidth }} {{ rate_unit }}{% else -%}unknown{% endif -%}</span> | 
<span title="Burst: {% if relay['bandwidth_burst'] -%}{% set burst_unit = relays._determine_unit(relay['bandwidth_burst']) -%}{% set burst_bandwidth = relays._format_bandwidth_with_unit(relay['bandwidth_burst'], burst_unit) -%}{{ burst_bandwidth }} {{ burst_unit }}{% else -%}unknown{% endif -%}">{% if relay['bandwidth_burst'] -%}{% set burst_unit = relays._determine_unit(relay['bandwidth_burst']) -%}{% set burst_bandwidth = relays._format_bandwidth_with_unit(relay['bandwidth_burst'], burst_unit) -%}{{ burst_bandwidth }} {{ burst_unit }}{% else -%}unknown{% endif -%}</span>
</dd>
<dt>
IPv4 Exit Policy Summary
</dt>
<dd>
{% if relay['exit_policy_summary'] -%}
{%- set v4_summary = relay['exit_policy_summary'].items() -%}
<pre class="pre-scrollable">{% for k, v in v4_summary -%}
{{ k|escape }}: {{ '\n  ' + v|join('\n  ')|escape }}
{% endfor -%}
</pre>
{% else -%}
<pre>none</pre>
{% endif -%}
</dd>
<dt>
IPv6 Exit Policy Summary
</dt>
<dd>
{% if relay['exit_policy_v6_summary'] -%}
{%- set v6_summary = relay['exit_policy_v6_summary'].items() -%}
<pre class="pre-scrollable">{% for k, v in v6_summary -%}
{{ k|escape }}: {{ '\n  ' + v|join('\n  ')|escape }}
{% endfor -%}
</pre>
{% else -%}
<pre>none</pre>
{% endif -%}
</dd>
<dt>
Exit Policy
</dt>
<dd>
<pre class="pre-scrollable">{% for policy in relay['exit_policy'] -%}
{{ policy|escape }}
{% endfor -%}
</pre>
</dd>
{% if relay['effective_family']|length > 1 -%}
<dt title="Array of fingerprints of relays that are in an effective, mutual family relationship with this relay. These relays are part of this relay's family and they consider this relay to be part of their family. Always contains the relay's own fingerprint. Omitted if the descriptor containing this information cannot be found.">
Effective Family Members: {{ relay['effective_family']|length }} (<a href="{{ path_prefix }}family/{{ relay['fingerprint']|escape }}/">View</a>)
</dt>
{% else -%}
<dt title="Array of fingerprints of relays that are in an effective, mutual family relationship with this relay. These relays are part of this relay's family and they consider this relay to be part of their family. Always contains the relay's own fingerprint. Omitted if the descriptor containing this information cannot be found.">
Effective Family Member: {{ relay['effective_family']|length }}
</dt>
{% endif -%}
<dd>
<pre class="pre-scrollable">{% for e_relay in relay['effective_family'] -%}
{% if relay['effective_family']|length > 1 -%}
<a href="{{ e_relay|escape }}.html">{{ e_relay|escape }}</a>
{% else -%}
{{ e_relay|escape }}
{% endif -%}
{% endfor -%}
</pre>
</dd>
<dt title="Array of fingerprints of relays that are not in an effective, mutual family relationship with this relay. These relays are part of this relay's family but they don't consider this relay to be part of their family. Omitted if empty or if descriptor containing this information cannot be found.">
Alleged Family {% if relay['alleged_family'] and relay['alleged_family']|length == 1 -%}Member{% else -%}Members{% endif -%}: {% if relay['alleged_family'] -%}{{ relay['alleged_family']|length }}{% else -%}0{% endif -%}
</dt>
<dd>
{% if relay['alleged_family'] -%}
<pre class="pre-scrollable">{% for a_relay in relay['alleged_family'] -%}
{% if relay['alleged_family']|length > 1 -%}
<a href="{{ a_relay|escape }}.html">{{ a_relay|escape }}</a>
{% else -%}
{{ a_relay|escape }}
{% endif -%}
{% endfor -%}
{% else -%}
<pre class="pre-scrollable">none
{% endif -%}
</pre>
</dd>
</dl>
</div>
<div class="col-md-6">
<dl>
<dt>
Fingerprint
</dt>
<dd>
<pre>{{ relay['fingerprint']|escape }}</pre>
</dd>
<dt>
Flags
</dt>
<dd>
{% for flag in relay['flags'] -%}
{% if flag != 'StaleDesc' -%}
<a href="{{ path_prefix }}flag/{{ flag.lower()|escape }}/">
<img src="{{ path_prefix }}static/images/flags/{{ flag.lower()|escape }}.png"
title="{{ flag|escape }}"
alt="{{ flag|escape }}">
</a> {{ flag|escape }}
{% endif -%}
{% endfor -%}
</dd>

<dt>
Country
</dt>
<dd>
{% if relay['country'] -%}
<a href="{{ path_prefix }}country/{{ relay['country']|escape }}/">
<img src="{{ path_prefix }}static/images/cc/{{ relay['country']|escape }}.png"
title="{{ relay['country_name']|escape }}"
alt="{{ relay['country_name']|escape }}">
</a> {{ relay['country_name']|escape }}
{% else -%}
unknown
{% endif -%}
</dd>
<dt>
AS Number
</dt>
<dd>
{% if relay['as'] -%}
<a href='{{ path_prefix }}as/{{ relay['as']|escape }}/'>{{ relay['as']|escape
}}</a>
{% else -%}
unknown
{% endif -%}
<dt>
AS Name
</dt>
<dd>
{% if relay['as_name'] -%}
{{ relay['as_name']|escape }} (<a href='https://bgp.tools/{{ relay['as']|escape }}'>BGP</a>)
{% else -%}
unknown
{% endif -%}
<dt>
First Seen
</dt>
<dd>
<a href="{{ path_prefix }}first_seen/{{ relay['first_seen'].split(' ', 1)[0]|escape }}/">{{ relay['first_seen']|escape }}</a>
</dd>
<dt title="UTC timestamp when this relay was last seen in a network status consensus.">
Last Seen
</dt>
<dd>
{{ relay['last_seen']|escape }}
</dd>
<dt title="UTC timestamp when this relay was last (re-)started. Missing if router descriptor containing this information cannot be found.">
Last Restarted
</dt>
<dd>
{{ relay['last_restarted']|escape }}
</dd>
<dt title="UTC timestamp when this relay last stopped announcing an IPv4 or IPv6 address or TCP port where it previously accepted onion-routing or directory connections. This timestamp can serve as indicator whether this relay would be a suitable fallback directory.">
Last Changed Address or Port
</dt>
<dd>
{% if relay['last_changed_address_or_port'] -%}
{{ relay['last_changed_address_or_port']|escape }}
{% else -%}
unknown
{% endif -%}
</dd>
<dt>
Network Participation (Consensus Weight | Guard | Middle | Exit)
</dt>
<dd>
<span title="Fraction of this relay's consensus weight compared to the sum of all consensus weights in the network. This fraction is a very rough approximation of the probability of this relay to be selected by clients.">{% if relay['consensus_weight_fraction'] -%}{{ "%.2f"|format(relay['consensus_weight_fraction'] * 100) }}%{% else -%}N/A{% endif -%}</span> | 
<span title="Probability of this relay to be selected for the guard position. This probability is calculated based on consensus weights, relay flags, and bandwidth weights in the consensus. Path selection depends on more factors, so that this probability can only be an approximation.">{% if relay['guard_probability'] -%}{{ "%.2f"|format(relay['guard_probability'] * 100) }}%{% else -%}N/A{% endif -%}</span> | 
<span title="Probability of this relay to be selected for the middle position. This probability is calculated based on consensus weights, relay flags, and bandwidth weights in the consensus. Path selection depends on more factors, so that this probability can only be an approximation.">{% if relay['middle_probability'] -%}{{ "%.2f"|format(relay['middle_probability'] * 100) }}%{% else -%}N/A{% endif -%}</span> | 
<span title="Probability of this relay to be selected for the exit position. This probability is calculated based on consensus weights, relay flags, and bandwidth weights in the consensus. Path selection depends on more factors, so that this probability can only be an approximation.">{% if relay['exit_probability'] -%}{{ "%.2f"|format(relay['exit_probability'] * 100) }}%{% else -%}N/A{% endif -%}</span>
</dd>
<dt>
Platform
</dt>
<dd>
<a href='{{ path_prefix }}platform/{{ relay['platform']|escape }}/'>{{
relay['platform'] }}</a>
</dd>
<dt>
Version (Running | Recommended | Status)
</dt>
<dd>
<span title="Tor software version without leading 'Tor' as reported by the directory authorities in the 'v' line of the consensus. Omitted if either the directory authorities or the relay did not report which version the relay runs or if the relay runs an alternative Tor implementation.">{% if relay['version'] -%}{{ relay['version']|escape }}{% else -%}unknown{% endif -%}</span> | 
<span title="Boolean field saying whether the Tor software version of this relay is recommended by the directory authorities or not. Uses the relay version in the consensus. Omitted if either the directory authorities did not recommend versions, or the relay did not report which version it runs.">{% if relay['recommended_version'] is not none -%}{% if relay['recommended_version'] -%}Yes{% else -%}No{% endif -%}{% else -%}unknown{% endif -%}</span> | 
<span title="Status of the Tor software version of this relay based on the versions recommended by the directory authorities. Possible version statuses are: 'recommended' if a version is listed as recommended; 'experimental' if a version is newer than every recommended version; 'obsolete' if a version is older than every recommended version; 'new in series' if a version has other recommended versions with the same first three components, and the version is newer than all such recommended versions, but it is not newer than every recommended version; 'unrecommended' if none of the above conditions hold. Omitted if either the directory authorities did not recommend versions, or the relay did not report which version it runs.">{% if relay['version_status'] -%}{{ relay['version_status']|escape }}{% else -%}unknown{% endif -%}</span>
</dd>
</dl>
</div>
</div>
</div>
{% endblock -%}
